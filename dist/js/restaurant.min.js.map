{"version":3,"sources":["webpack:///./src/js/utils/DBHelper.js","webpack:///./src/js/utils/loadGoogleMaps.js","webpack:///./src/js/utils/Map.js","webpack:///./src/js/utils/getUrlParameter.js","webpack:///./src/js/controllers/RestaurantController.js"],"names":["DBHelper","photograph","_ref","arguments","length","undefined","concat","this","BASE_URL","id","_ref2","fetch","DB_URL","then","response","ok","Error","json","results","restaurants","catch","console","error","fetchRestaurants","filter","r","restaurantId","fetchRestaurant","_ref3","reviews","Math","max","round","reduce","a","c","rating","toFixed","_config__WEBPACK_IMPORTED_MODULE_0__","HOST","PORT","__webpack_exports__","node","document","body","script","createElement","setAttribute","MAPS_KEY","appendChild","Map","mount","options","_classCallCheck","getElementById","_options","Object","assign","zoom","center","lat","lng","disableDefaultUI","scrollwheel","_googleMap","google","maps","markers","lastMarker","data","onClick","_this","bounds","LatLngBounds","map","item","marker","addMarkerWithInfoWindow","extend","position","GoogleMap","fitBounds","setZoom","content","Marker","animation","Animation","DROP","_this2","addMarker","infoWindow","InfoWindow","addListener","close","panTo","getPosition","panBy","forEach","i","setMap","event","clearInstanceListeners","utils_getUrlParameter","param","URLSearchParams","location","search","get","replace","RegExp","exec","decodeURIComponent","self","initMap","RestaurantController","loadMap","generateStarsHtml","star","docFrag","createDocumentFragment","textContent","tmp","cloneNode","generateStarRatingHtml","div","container","top","bottom","className","style","width","restaurant","pageElements","breadcrumbs","querySelector","restaurantContainer","restaurantName","restaurantCuisine","restaurantHoursToday","restaurantAddress","restaurantNeighborhood","restaurantStarRating","restaurantHoursContainer","restaurantImageContainer","reviewsContainer","render","loadGoogleMaps","title","name","fillBreadcrumb","renderRestaurant","generateImage","populateHeader","generateAverageRating","populateAddress","populateDetails","renderReviews","_this$pageElements","_this$restaurant","cuisine","cuisine_type","operatingHours","operating_hours","currentDay","keys","Date","getDay","altText","image","src","restaurantImgUrl","alt","onload","acc","review","averageRating","link","_this$pageElements2","_this$restaurant2","address","neighborhood","table","tr","thead","thead_tr","tbody","tbody_tr","th","td","day","day_th","day_td","innerHTML","includes","generateHoursHtml","paragraph","reviewsList","li","p","reviewTop","reviewBody","username","starRating","date","comment","comments","generateReviewHtml","classList","add","latlng","updateMap"],"mappings":"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","file":"./js/restaurant.min.js","sourcesContent":["import config from '../config';\n\nclass DBHelper {\n  static get BASE_URL() {\n    return `${config.HOST}${config.PORT && `:${config.PORT}`}`;\n  }\n\n  static get DB_URL(){\n    return `./data/restaurants.json`;\n  }\n\n  static restaurantImgUrl({ photograph }, relative = true) {\n    return (relative)\n     ? `./images/${photograph}`\n     : `${this.BASE_URL}/images/${photograph}`;\n  }\n\n  static restaurantUrl({ id }, relative = true) {\n    return (relative)\n     ? `./restaurant.html?id=${id}`\n     : `${this.BASE_URL}/restaurant.html?id=${id}`;\n  }\n\n  static fetchRestaurants() {\n    return fetch(this.DB_URL)\n      .then(response => {\n        if(!response.ok) {\n          throw Error('Unable to retrieve restaurant data');\n        }\n        \n        return response.json();\n      })\n      .then(results => results.restaurants)\n      .catch(console.error);\n  }\n\n  static fetchRestaurant(id) {\n    return this.fetchRestaurants()\n      .then(restaurants => restaurants.filter(r => r.id === id)[0]);\n  }\n\n  static calculateAverageReview(restaurantId) {\n    return this.fetchRestaurant(restaurantId)\n      .then(({ reviews }) => {\n        if (!reviews) return 0;\n\n        // Stand back, we're going to try mathematics!\n        return Math.max(\n                Math.round(\n                  (reviews.reduce((a, c) => a + c.rating, 0) / reviews.length) * 10\n                ) / 10, 1\n              ).toFixed(1);\n      })\n      .catch(console.error);\n  }\n};\n\nexport default DBHelper;\n","import config from '../config';\n\n/**\n * Appends the Google Maps API script at the end of the document.body \n * or the specified node, if provided.\n * @param {HTMLElement} node \n */\nconst loadGoogleMaps = (node = document.body) => {\n  const script = document.createElement('script');\n\n  script.setAttribute('src', `https://maps.googleapis.com/maps/api/js?key=${config.MAPS_KEY}&libraries=places&callback=initMap`);\n  script.setAttribute('async', '');\n  script.setAttribute('defer', '');\n  node.appendChild(script);\n};\n\nexport default loadGoogleMaps;\n","class Map {\n  constructor(mount, options) {\n    mount = mount || document.getElementById('map');\n    const defaultOptions = { \n      zoom: 12, \n      center: {\n        lat: 40.722216,\n        lng: -73.987501\n      }, \n      disableDefaultUI: true,\n      scrollwheel: false,\n    };\n\n    this._options = Object.assign({}, defaultOptions, options);\n\n    this._googleMap = new google.maps.Map(mount, this._options);\n    this.markers = [];\n    this.lastMarker = null;\n  }\n\n  get GoogleMap() {\n    return this._googleMap;\n  }\n\n  addMarkers(data, onClick) {\n    let bounds = new google.maps.LatLngBounds();\n    this.markers = data.map(item => {\n      let marker = this.addMarkerWithInfoWindow(item, onClick);\n      bounds.extend(marker.position);\n\n      return marker;\n    });\n\n    // Fit the map to the boundaries of the markers\n    if (this.markers.length > 0) {\n      this.GoogleMap.fitBounds(bounds);\n      this.GoogleMap.setZoom(this._options.zoom);\n    }\n  }\n\n  addMarker({ position, content }) {\n    return new google.maps.Marker({\n      animation: google.maps.Animation.DROP,\n      map: this.GoogleMap,\n      position,\n      content,\n    });\n  }\n\n  addMarkerWithInfoWindow(item, onClick) {\n    // Create a new marker and define marker properties\n    const marker = this.addMarker(item);\n\n    // Create a new infowindow\n    const infoWindow = new google.maps.InfoWindow();\n\n    marker.addListener('click', () => {\n      // Close the most recently opened infowindow\n      this.lastMarker && this.lastMarker.close();\n\n      // Reset the last clicked infowindow to this one\n      this.lastMarker = infoWindow;\n\n      // Pan the map to the center of the clicked marker\n      this.GoogleMap.panTo(marker.getPosition());\n\n      // Pan the map downward to accommodate the info window\n      this.GoogleMap.panBy(0, -150);\n\n      // Show the infowindow\n      onClick(infoWindow, marker);\n    });\n\n    return marker;\n  }\n\n  resetMarkers() {\n    this.markers.forEach((marker, i) => {\n      marker.setMap(null);\n      google.maps.event.clearInstanceListeners(marker);\n    });\n\n    this.markers = [];\n  }\n}\n\nexport default Map;\n","/**\n * Returns the value of the specified query string parameter \n * of the current URI.\n */\nconst getUrlParameter = param => {\n  if (!param) return;\n\n  // If URLSearchParams is supported, use that\n  if (URLSearchParams) {\n    const urlParams = new URLSearchParams(location.search);\n    return urlParams.get(param);\n  }\n\n  // Otherwise, parse the param using regular expressions\n  param = param.replace(/[\\[]/, '\\\\[').replace(/[\\]]/, '\\\\]');\n  const regex = new RegExp(`[\\\\?&]${param}=([^&#]*)`);\n  const results = regex.exec(location.search);\n  return results === null ? '' : decodeURIComponent(results[1].replace(/\\+/g, ' '));\n};\n\nexport default getUrlParameter;\n","import config from '../config';\nimport DBHelper from '../utils/DBHelper';\nimport Map from '../utils/Map';\nimport loadGoogleMaps from '../utils/loadGoogleMaps';\nimport getUrlParameter from '../utils/getUrlParameter';\n\n/**\n * Called when Google Maps API is ready\n * @global\n */\nself.initMap = () => {\n  RestaurantController.loadMap();\n};\n\n/**\n * Calculates average rating percentage\n */\nconst averageRating = reviews => {\n  const TOP_RATING = 5;\n  const total = reviews.reduce((acc, review) => {\n    return acc + review.rating;\n  }, 0);\n\n  return (total / (reviews.length * TOP_RATING) * 100);\n};\n\n/**\n * Generates the HTML output for the operating hours table\n */\nconst generateHoursHtml = operatingHours => {\n  const docFrag = document.createDocumentFragment();\n  const table = document.createElement('table');\n  const tr = document.createElement('tr');\n  const thead = document.createElement('thead');\n  const thead_tr = tr.cloneNode();\n  const tbody = document.createElement('tbody');\n  const tbody_tr = tr.cloneNode();\n  const th = document.createElement('th');\n  const td = document.createElement('td');\n\n  table.className = 'restaurant__hours';\n\n  thead.appendChild(thead_tr);\n  tbody.appendChild(tbody_tr);\n\n  for (let day in operatingHours) {\n    let day_th = th.cloneNode();\n    let day_td = td.cloneNode();\n\n    day_th.textContent = day;\n    day_td.innerHTML = (operatingHours[day].includes(',') ? operatingHours[day].replace(', ', '<br>') : operatingHours[day]);\n    day_td.setAttribute('data-th', day);\n\n    thead_tr.appendChild(day_th);\n    tbody_tr.appendChild(day_td);\n  }\n\n  table.appendChild(thead);\n  table.appendChild(tbody);\n\n  docFrag.appendChild(table);\n  \n  return docFrag;\n};\n\n/**\n * Generates the stars used for the ratings\n */\nconst generateStarsHtml = () => {\n  const RATING_LIMIT = 5;\n  const star = document.createElement('span');\n  const docFrag = document.createDocumentFragment();\n\n  star.textContent = 'â˜…';\n  \n  for (let i=RATING_LIMIT; i>0; i--) {\n    let tmp = star.cloneNode(true);\n    docFrag.appendChild(tmp);\n  }\n\n  return docFrag;\n}\n\n/**\n * Generates the HTML output for a star rating\n */\nconst generateStarRatingHtml = rating => {\n  const div = document.createElement('div');\n\n  const container = div.cloneNode();\n  const top = div.cloneNode();\n  const bottom = div.cloneNode();\n\n  container.className = 'star-rating__container';\n\n  top.className = 'star-rating__top';\n  top.style.width = `${rating}%`;\n  top.appendChild(generateStarsHtml());\n  container.appendChild(top);\n\n  bottom.className = 'star-rating__bottom';\n  bottom.appendChild(generateStarsHtml());\n  container.appendChild(bottom);\n\n  return container;\n};\n\n/**\n * Generates the HTML output for a review\n */\nconst generateReviewHtml = review => {\n  const li = document.createElement('li');\n  const div = document.createElement('div');\n  const p = document.createElement('p');\n  const reviewTop = div.cloneNode();\n  const reviewBody = div.cloneNode();\n  const username = p.cloneNode();\n  const starRating = div.cloneNode();\n  const date = p.cloneNode();\n  const comment = p.cloneNode();\n\n  li.className = 'restaurant__review';\n  reviewTop.className = 'review__top';\n  reviewBody.className = 'review__body';\n\n  // Review Top\n  username.textContent = review.name;\n  username.className = 'review__username';\n  reviewTop.appendChild(username);\n\n  starRating.className = 'star-rating';\n  starRating.setAttribute('aria-label', `User rating: ${review.rating}`);\n  starRating.appendChild(generateStarRatingHtml((review.rating / 5) * 100));\n  reviewTop.appendChild(starRating);\n  \n  // Review Body\n  date.textContent = review.date;\n  date.className = 'review__date';\n  comment.innerHTML = review.comments;\n  comment.className = 'review__comment';\n  reviewBody.appendChild(date);\n  reviewBody.appendChild(comment);\n\n  li.appendChild(reviewTop);\n  li.appendChild(reviewBody);\n\n  return li;\n};\n\n/**\n * The restaurant page controller\n */\nconst RestaurantController = {\n  map: null,\n  restaurant: null,\n  pageElements: {\n    breadcrumbs: document.querySelector('.breadcrumbs__nav-list'),\n    restaurantContainer: document.querySelector('.restaurant'),\n    restaurantName: document.querySelector('.restaurant__name'),\n    restaurantCuisine: document.querySelector('.restaurant__cuisine'),\n    restaurantHoursToday: document.querySelector('.hours-today__text'),\n    restaurantAddress: document.querySelector('.restaurant__address'),\n    restaurantNeighborhood: document.querySelector('.restaurant__neighborhood'),\n    restaurantStarRating: document.querySelector('.restaurant__star-rating'),\n    restaurantHoursContainer: document.querySelector('.restaurant__hours-container'),\n    restaurantImageContainer: document.querySelector('.restaurant__image-container'),\n    reviewsContainer: document.querySelector('.restaurant__reviews-container'),\n  },\n\n  /**\n   * Page controller entry point to begin rendering page elements\n   */\n  render() {\n    const restaurantId = +getUrlParameter('id');\n\n    if (!restaurantId) {\n      console.error('The restaurant ID could not be located');\n      return;\n    }\n\n    DBHelper.fetchRestaurant(restaurantId)\n      .then(restaurant => {\n        if (!restaurant) {\n          console.error(`Unable to retrieve a restaurant with the ID ${restaurantId}`);\n          return;\n        }\n\n        loadGoogleMaps();\n        this.restaurant = restaurant;\n        document.title += ` | ${this.restaurant.name}`;\n\n        this.fillBreadcrumb();\n        this.renderRestaurant();\n      })\n      .catch(console.error);\n  },\n\n  /**\n   * Renders restaurant information\n   */\n  renderRestaurant() {\n    // Populate restaurant content\n    this.generateImage();\n    this.populateHeader();\n    this.generateAverageRating();\n    this.populateAddress();\n    this.populateDetails();\n    this.renderReviews();\n  },\n\n  /**\n   * Populates the restaurant header with content\n   */\n  populateHeader() {\n    const { restaurantName, restaurantCuisine, restaurantHoursToday } = this.pageElements;\n    const { name, cuisine_type: cuisine, operating_hours: operatingHours } = this.restaurant;\n    const daysOfTheWeek = Object.keys(operatingHours);\n    const currentDay = daysOfTheWeek[new Date().getDay() - 1];\n    \n    restaurantName.textContent = name;\n    restaurantCuisine.textContent = cuisine;\n    restaurantHoursToday.textContent = operatingHours[currentDay];\n  },\n\n  /**\n   * Generates an IMG element for the current restaurant\n   */\n  generateImage() {\n    const { restaurantImageContainer } = this.pageElements;\n    const { altText } = this.restaurant;\n    const image = document.createElement('img');\n\n    image.src = DBHelper.restaurantImgUrl(this.restaurant);\n    image.alt = altText;\n    image.className = 'restaurant__image';\n    image.onload = event => {\n      restaurantImageContainer.appendChild(image);\n    };\n  },\n\n  /**\n   * Generates the average star rating\n   */\n  generateAverageRating() {\n    const { restaurantStarRating } = this.pageElements;\n    const { reviews } = this.restaurant;\n    const rating = averageRating(reviews);\n    const link = document.createElement('a');\n\n    // Add stars\n    restaurantStarRating.appendChild(generateStarRatingHtml(rating));\n\n    // Add link\n    link.setAttribute('href', '#reviews');\n    link.setAttribute('title', 'Skip to customer reviews');\n    link.className = 'star-rating__link';\n    link.textContent = `${reviews.length} reviews`;\n\n    restaurantStarRating.appendChild(link);\n  },\n\n  /**\n   * Populates the restaurant address and neighborhood\n   */\n  populateAddress() {\n    const { restaurantAddress, restaurantNeighborhood } = this.pageElements;\n    const { address, neighborhood } = this.restaurant;\n\n    restaurantAddress.textContent = address;\n    restaurantNeighborhood.textContent = neighborhood;\n  },\n\n  /**\n   * Populates restaurant details section\n   */\n  populateDetails() {\n    const { restaurantHoursContainer } = this.pageElements;\n    const { operating_hours: operatingHours } = this.restaurant;\n\n    restaurantHoursContainer.appendChild(generateHoursHtml(operatingHours));\n  },\n  \n  /**\n   * Renders reviews if there are any\n   */\n  renderReviews() {\n    const { reviews } = this.restaurant;\n    const { reviewsContainer } = this.pageElements;\n    const docFrag = document.createDocumentFragment();\n\n    if (!reviews) {\n      const paragraph = document.createElement('p');\n\n      paragraph.textContent = `${this.restaurant.name} does not have any reviews`;\n      paragraph.className = 'restaurant-reviews__empty';\n      reviewsContainer.appendChild(paragraph);\n\n      return;\n    }\n\n    const reviewsList = document.createElement('ul');\n    reviewsList.className = 'restaurant__reviews';\n\n    reviews.forEach(review => {\n      docFrag.appendChild(generateReviewHtml(review));\n    });\n\n    reviewsList.appendChild(docFrag);\n    reviewsContainer.appendChild(reviewsList);\n  },\n\n  /**\n   * Populates the page breadcrumbs\n   */\n  fillBreadcrumb() {\n    const { breadcrumbs } = this.pageElements;\n    const li = document.createElement('li');\n    \n    li.textContent = this.restaurant.name;\n    li.classList.add('breadcrumbs__nav-item');\n    li.setAttribute('aria-current', 'page');\n\n    breadcrumbs.appendChild(li);\n  },\n\n  /**\n   * Called by initMap once Google Maps API is ready.\n   * Create a new map and updates it\n   */\n  loadMap() {\n    this.map = new Map(null, {\n      zoom: 16,\n      center: this.restaurant.latlng,\n      scrollwheel: false,\n    });\n\n    this.restaurant && this.updateMap();\n  },\n\n  /**\n   * Updates the Google Map\n   */\n  updateMap() {\n    if (!this.map) {\n      return;\n    }\n\n    this.map.addMarker({\n      position: this.restaurant.latlng,\n      content: {}\n    });\n  }\n}\n\nexport default RestaurantController;\n"],"sourceRoot":""}
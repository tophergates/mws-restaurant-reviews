(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{340:function(e,r,t){(e.exports=t(90)(!1)).push([e.i,'.breadcrumbs{background:hsla(0,0%,93%,.25);border-bottom:1px inset rgba(51,51,51,.25);min-height:4.6666rem;padding:1.06667rem}.breadcrumbs__nav-list{list-style:none;margin:0;padding:0}.breadcrumbs__nav-item{display:inline}.breadcrumbs__nav-item:first-of-type:after{display:inline-block;margin:0 .8rem;transform:rotate(15deg);border-right:.125rem solid currentColor;height:1.2rem;content:""}.breadcrumbs__nav-item[aria-current=page]{color:#333;font-weight:700;text-decoration:none}.breadcrumbs__nav-item[aria-current=page]:after{content:""}.breadcrumbs__link{color:#b22200}.breadcrumbs__link:active,.breadcrumbs__link:focus{outline:none;text-decoration:underline}.restaurant__map-container{display:flex;flex:0 1 auto;flex-direction:column;height:auto;max-width:100%}.restaurant__map-container .restaurant__map{background-color:transparent;border:1px inset rgba(51,51,51,.25);border-bottom:0;flex:1 0 auto;height:auto;min-height:12.5rem;opacity:1;position:relative;transition:opacity 1s ease;width:100%}.restaurant__map-container .restaurant__map .restaurant__map-loading{color:rgba(51,51,51,.85);display:block;font-weight:700;left:50%;position:absolute;top:50%;transform:translate(-50%,-50%)}.restaurant{display:grid;grid-template-areas:"h" "s" "i" "m" "d" "r"}.restaurant .restaurant__header{grid-area:h}.restaurant .restaurant__star-rating{grid-area:s}.restaurant .restaurant__image-container{grid-area:i;padding:0;min-width:100%}.restaurant .restaurant__image-container .restaurant__image{width:100%}.restaurant .restaurant__map-container{grid-area:m}.restaurant .restaurant__details{grid-area:d}.restaurant .restaurant__reviews-container{grid-area:r}@media screen and (min-width:825px){.restaurant{grid:"i i h h h h h" "i i s s s s s" "i i d d d d d";grid-template-columns:250px 1fr repeat(4,1fr);grid-template-rows:auto auto 1fr;column-gap:1rem;margin:0 2rem;padding:1.6rem}.restaurant .restaurant__image-container{height:auto;max-height:600px;max-width:800px;margin:auto}.restaurant .restaurant__image-container .restaurant__image{border-radius:2.4rem}}.restaurant__header{padding:.8rem}.restaurant__header .restaurant__name{display:flex;justify-content:space-between}.restaurant__header .restaurant__name .restaurant__name--text{color:#b22200;font-size:3.2rem;letter-spacing:.025ch;line-height:1;padding-bottom:.8rem}.restaurant__header .restaurant__name .restaurant__favorite{background:transparent;border:none}.restaurant__header .restaurant__name .restaurant__favorite.true{color:#b22200}.restaurant__header .restaurant__name .restaurant__favorite.false{color:#333}.restaurant__header .restaurant__cuisine,.restaurant__header .restaurant__hours-today{color:#737373;display:block;font-size:1.6rem;padding:0}.restaurant__header .restaurant__hours-today{padding-bottom:.8rem}.restaurant__star-rating,.star-rating{align-items:center;display:flex;flex-wrap:nowrap;margin:-.8rem 0 .8rem;padding:0 .8rem}.restaurant__star-rating .star-rating__container{color:#666}.restaurant__details{padding:.8rem}.subheading{color:#b22200;font-size:2.4rem;margin-bottom:.8rem}.restaurant__hours{border:0;border-collapse:collapse;min-width:100%}.restaurant__hours thead th{background:#b22200;color:#fff}.restaurant__hours td{padding:.8rem;text-align:center}@media screen and (max-width:550px){.restaurant__hours,.restaurant__hours tbody,.restaurant__hours td,.restaurant__hours th,.restaurant__hours thead,.restaurant__hours tr{display:block}.restaurant__hours thead tr{position:absolute;top:-9999px;left:-9999px}.restaurant__hours tbody tr{border:1px solid #eee;border-radius:.3rem;margin:1.06667rem 0 2.4rem}.restaurant__hours tbody tr:last-child{margin-bottom:0}.restaurant__hours tbody tr td:nth-child(2n){background:hsla(0,0%,93%,.5)}.restaurant__hours tbody tr td:nth-child(4n){border-bottom:1px solid transparent}.restaurant__hours td{border-bottom:1px solid #eee;position:relative;padding:1.06667rem 0 1.06667rem 50%}.restaurant__hours td:before{font-style:normal;position:absolute;left:.5rem;content:attr(data-th);font-weight:700;text-transform:uppercase}}.restaurant__reviews-container{padding:1.06667rem}@media screen and (min-width:825px){.restaurant__reviews-container{margin:0 3rem}.restaurant__reviews-container .review-form__container{float:left;margin-right:1.06667rem;min-width:32rem;padding:1.06667rem}.restaurant__reviews-container .review-form__container .review-form__title{font-size:1.8rem}}.review-form .review-form__row{padding:.8rem 0}.review-form .review-form__row label{font-weight:700}.review-form .review-form__row input,.review-form .review-form__row select,.review-form .review-form__row textarea{background:transparent;border:1px solid #333;font-size:1.6rem;width:100%}.review-form .review-form__row select{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:5px;color:#ffb100}.review-form .review-form__row textarea{min-height:15rem}.review-form .review-form__row .submit-button{background:#9affdc;color:#333;padding:.8rem;width:100%}.restaurant__reviews{display:grid;grid-row-gap:3rem;grid-column-gap:3rem;grid-template-columns:repeat(auto-fill,minmax(32rem,100%))}.restaurant__reviews .restaurant__review{border:1px solid rgba(51,51,51,.25);border-radius:.8rem;margin-bottom:2rem}.restaurant__reviews .restaurant__review .review__top{background:#333;border-radius:.8rem .8rem 0 0;color:#eee;padding:.8rem}.restaurant__reviews .restaurant__review .review__top .review__username{display:inline-block;text-transform:uppercase;font-size:1.6rem}.restaurant__reviews .restaurant__review .review__top .star-rating{float:right;margin:0;padding:0}.restaurant__reviews .restaurant__review .review__body{padding:.8rem}.restaurant__reviews .restaurant__review .review__date{color:#737373;font-style:italic}.restaurant__reviews .restaurant__review .review__comment{margin:.8rem 0}.restaurant__reviews .restaurant__review.offline .review__top{background:#b22200}',""])},341:function(e,r,t){var a=t(340);"string"==typeof a&&(a=[[e.i,a,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};t(127)(a,n);a.locals&&(e.exports=a.locals)},342:function(e,r,t){var a;!function(n){"use strict";var i,s,o,u=(i=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZWN]|"[^"]*"|'[^']*'/g,s=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,o=/[^-+\dA-Z]/g,function(e,r,t,a){if(1!==arguments.length||"string"!==(null===(n=e)?"null":void 0===n?"undefined":"object"!=typeof n?typeof n:Array.isArray(n)?"array":{}.toString.call(n).slice(8,-1).toLowerCase())||/\d/.test(e)||(r=e,e=void 0),(e=e||new Date)instanceof Date||(e=new Date(e)),isNaN(e))throw TypeError("Invalid date");var n,c=(r=String(u.masks[r]||r||u.masks.default)).slice(0,4);"UTC:"!==c&&"GMT:"!==c||(r=r.slice(4),t=!0,"GMT:"===c&&(a=!0));var m=t?"getUTC":"get",l=e[m+"Date"](),_=e[m+"Day"](),v=e[m+"Month"](),h=e[m+"FullYear"](),g=e[m+"Hours"](),p=e[m+"Minutes"](),f=e[m+"Seconds"](),b=e[m+"Milliseconds"](),w=t?0:e.getTimezoneOffset(),y=function(e){var r=new Date(e.getFullYear(),e.getMonth(),e.getDate());r.setDate(r.getDate()-(r.getDay()+6)%7+3);var t=new Date(r.getFullYear(),0,4);t.setDate(t.getDate()-(t.getDay()+6)%7+3);var a=r.getTimezoneOffset()-t.getTimezoneOffset();r.setHours(r.getHours()-a);var n=(r-t)/6048e5;return 1+Math.floor(n)}(e),M=function(e){var r=e.getDay();return 0===r&&(r=7),r}(e),T={d:l,dd:d(l),ddd:u.i18n.dayNames[_],dddd:u.i18n.dayNames[_+7],m:v+1,mm:d(v+1),mmm:u.i18n.monthNames[v],mmmm:u.i18n.monthNames[v+12],yy:String(h).slice(2),yyyy:h,h:g%12||12,hh:d(g%12||12),H:g,HH:d(g),M:p,MM:d(p),s:f,ss:d(f),l:d(b,3),L:d(Math.round(b/10)),t:g<12?u.i18n.timeNames[0]:u.i18n.timeNames[1],tt:g<12?u.i18n.timeNames[2]:u.i18n.timeNames[3],T:g<12?u.i18n.timeNames[4]:u.i18n.timeNames[5],TT:g<12?u.i18n.timeNames[6]:u.i18n.timeNames[7],Z:a?"GMT":t?"UTC":(String(e).match(s)||[""]).pop().replace(o,""),o:(w>0?"-":"+")+d(100*Math.floor(Math.abs(w)/60)+Math.abs(w)%60,4),S:["th","st","nd","rd"][l%10>3?0:(l%100-l%10!=10)*l%10],W:y,N:M};return r.replace(i,function(e){return e in T?T[e]:e.slice(1,e.length-1)})});function d(e,r){for(e=String(e),r=r||2;e.length<r;)e="0"+e;return e}u.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},u.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},void 0===(a=function(){return u}.call(r,t,r,e))||(e.exports=a)}()},350:function(e,r,t){"use strict";t.r(r);var a=t(342),n=t.n(a),i=t(339);t(341);function s(e){return function(e){if(Array.isArray(e)){for(var r=0,t=new Array(e.length);r<e.length;r++)t[r]=e[r];return t}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var o=function(e){var r,t,a,n,s,o,u,d,c,m,l,_,v,h,g,p,f,b,w,y,M,T,x=[];return x.push((t=(r=e).address,a=r.name,n=r.cuisine_type,s=r.operating_hours,o=r.is_favorite,u=Object.keys(s),d=(new Date).getDay(),c=u[d>0?d-1:d],m="restaurant__favorite ".concat(o)||"restaurant__favorite false",l="true"===o?"Favorite":"Make a Favorite",_="true"===o?"Remove as a favorite":"Mark as a favorite",'\n    <div class="restaurant__header">\n      <div class="restaurant__name">\n        <h2 class="restaurant__name--text">'.concat(a,'</h2>\n        <button aria-label="').concat(_,'" class="').concat(m,'">♥ ').concat(l,'</button> \n      </div>\n      <address class="restaurant__address">').concat(t,'</address>\n      <span class="restaurant__cuisine">').concat(n,'</span>\n      <p class="restaurant__hours-today">Hours today:\n        <span class="hours-today__text">').concat(s[c],"</span>\n      </p>\n    </div>\n  "))),x.push((h="restaurant__image",g=(v=e).id,p=v.altText,f=Object(i.e)({id:g,src:i.a.restaurantImgUrl({id:g,size:"small"}),sizes:"100vw",alt:p,className:h}),'<div class="restaurant__image-container">'.concat(f,"</div>"))),x.push((b=e.reviews,w=e.averageReview,y=Object(i.f)(w),M='<a href="#reviews" title="Skip to customer reviews" class="star-rating__link">'.concat(b.length," reviews</a>"),'\n    <div class="restaurant__star-rating">\n      '.concat(y,"\n      ").concat(M,"\n    </div>\n  "))),x.push((T=function(e){var r=[],t=[];for(var a in e){var n=e[a].includes(",")?e[a].replace(", ","<br>"):e[a];r.push("<th>".concat(a,"</th>")),t.push('<td data-th="'.concat(a,'">').concat(n,"</td>"))}return'\n    <table class="restaurant__hours">\n      <thead>'.concat(r.join(""),"</thead>\n      <tbody>").concat(t.join(""),"</tbody>\n    </table>\n  ")}(e.operating_hours),'\n    <div class="restaurant__details">\n      <div class="restaurant__hours-container">\n        <h3 class="subheading">Operating Hours</h3>\n        '.concat(T,"\n      </div>\n    </div>\n  "))),x.join("")},u=function(e){var r=e.comments,t=e.createdAt,a=e.name,s=e.rating,o=e.pending;return'\n    <li class="restaurant__review'.concat(!0===o?" offline":"",'">\n      <div class="review__top">\n        <p class="review__username">').concat(a,'</p>\n        <div class="star-rating" aria-label="User rating: ').concat(s,'">\n          ').concat(Object(i.f)(s/i.a.MAX_REVIEW_SCORE*100),'\n        </div>\n      </div>\n      <div class="review__body">\n        <p class="review__date">').concat(n()(new Date(t),"mm/dd/yyyy h:MM TT"),'</p>\n        <p class="review__comment">').concat(r,"</p>\n      </div>\n    </li>\n  ")},d=function(e){var r=[];return r.push('<h3 class="subheading">User Reviews</h3>'),r.push(function(){for(var e=[],r=1;r<=i.a.MAX_REVIEW_SCORE;r++)e.push("<option value=".concat(r,">").concat(Array(r).fill("★").join(""),"</option>"));return'\n    <div class="review-form__container">\n      <h4 class="review-form__title">Add Review</h4>\n      <form class="review-form">\n        <div class="review-form__row">\n          <label for="author">Author:</label>\n          <input type="text" name="name" id="author" required>\n        </div>\n        <div class="review-form__row">\n          <label for="rating">Rating:</label>\n          <select aria-label="Select rating" id="rating" name="rating" required>\n            '.concat(e.join(""),'\n          </select>\n        </div>\n        <div class="review-form__row">\n          <label for="comments">Comments:</label>\n          <textarea id="comments" name="comments" required></textarea>\n        </div>\n        <div class="review-form__row">\n          <button class="submit-button">Submit</button>\n        </div>\n      </form>\n    </div>\n  ')}()),r.push(function(e){var r=[];return!e||e&&0===e.length?(r.push('<p class="restaurant-reviews__empty">There are currently no reviews for this restaurant. Yours could be first!</p>'),r.join("")):(r.push('<ul class="restaurant__reviews">'),r.push(e.map(u).join("")),r.push("</ul>"),r.join(""))}(e)),r.join("")},c={state:{restaurant:null,errors:[],isLoading:!0,online:navigator.onLine},map:null,elements:{breadcrumbs:document.querySelector(".breadcrumbs"),restaurantContainer:document.querySelector(".restaurant"),reviewsContainer:document.querySelector(".restaurant__reviews-container")},setState:function(e){var r=this.state;this.state=Object.assign(r,e(r)),this.render()},init:function(){var e=this;this.render();var r=+Object(i.c)("id");r?(i.a.fetchRestaurantWithReviews(r).then(function(r){e.setState(function(e){var t=e.isLoading;return{restaurant:r,errors:[],isLoading:!t}}),e.loadMap()}).catch(function(){e.setState(function(e){var r=e.errors,t=e.isLoading;return{errors:s(r).concat(["Oh no! We were unable to locate the restaurant you requested."]),isLoading:!t}})}),window.addEventListener("online",this.addPendingReviews.bind(this))):this.setState(function(e){var r=e.errors,t=e.isLoading;return{errors:s(r).concat(["A restaurant ID was not specified."]),isLoading:!t}})},notLoadingNoErrors:function(){var e=this.state,r=e.isLoading,t=e.errors,a=this.elements.restaurantContainer;if(r)return a.innerHTML='<p class="restaurant-result info">Loading restaurant...</p>',!1;if(t&&t.length>0){var n=t.map(function(e){return"<p>".concat(e,"</p>")}).join("");return a.innerHTML='<div class="restaurant-result error">'.concat(n,"</div>"),!1}return!0},updatePage:function(){var e=this.state.restaurant.name,r=this.elements.breadcrumbs;document.title+=" | ".concat(e),r.innerHTML='\n      <ol class="breadcrumbs__nav-list">\n        <li class="breadcrumbs__nav-item">\n          <a href="./" class="breadcrumbs__link" title="Return to the Restaurant Reviews home page">Home</a>\n        </li>\n        <li class="breadcrumbs__nav-item" aria-current="page">'.concat(e,"</li>\n      </ol>\n    ")},populateRestaurant:function(){var e=this.state.restaurant;this.elements.restaurantContainer.innerHTML=o(e),Object(i.d)()},loadMap:function(){var e=this.state.restaurant.latlng;this.map=new i.b(document.querySelector(".restaurant__map"),{zoom:16,center:[e.lat,e.lng],dragging:!1}),this.map.addMarkers([{position:[e.lat,e.lng]}],function(e){return e.target.closePopup()})},populateReviews:function(){var e=this.state.restaurant.reviews;this.elements.reviewsContainer.innerHTML=d(e)},addNewReview:function(e){var r=this;e.preventDefault();var t=e.target.elements,a=t.name,n=t.rating,s=t.comments,o={restaurant_id:this.state.restaurant.id,rating:+n.value,name:a.value,comments:s.value.substring(0,300),createdAt:new Date};i.a.addRestaurantReview(o).then(function(e){var t=r.state.restaurant;e&&Array.isArray(e)?t.reviews=e:t.reviews.push(Object.assign(o,{pending:!0})),t.averageReview=i.a.calculateAverageReview(t.reviews),r.setState(function(){return{restaurant:t}})})},addPendingReviews:function(){var e=this;if(navigator.onLine){var r=this.state.restaurant;i.a.addPendingReviews(r.id).then(function(r){Array.isArray(r)&&r.length>0&&e.setState(function(e){var t=e.restaurant;return t.reviews=r,t.averageReview=i.a.calculateAverageReview(t.reviews),{restaurant:t}})})}},handleFavoriteChange:function(){var e=this,r=this.state.restaurant,t=r.id,a="true"===r.is_favorite;i.a.setFavoriteRestaurant(t,!a).then(function(r){console.log(r.is_favorite),e.setState(function(e){var t=e.restaurant;return{restaurant:Object.assign({},t,{is_favorite:r.is_favorite})}})})},render:function(){this.notLoadingNoErrors()&&(this.updatePage(),this.populateRestaurant(),this.populateReviews(),document.querySelector(".review-form").addEventListener("submit",this.addNewReview.bind(this)),document.querySelector(".restaurant__favorite").addEventListener("click",this.handleFavoriteChange.bind(this)))}};r.default=c}}]);
//# sourceMappingURL=restaurant.min.js.map